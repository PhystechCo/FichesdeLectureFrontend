<div>

  <h3>{{labels[0].new.title}}</h3>

  <h4>{{labels[0].new.biblio}}</h4>

  <form [formGroup]="ficheForm" (ngSubmit)="onSubmit(ficheForm)" [class.blockerror]="!ficheForm.valid && ficheForm.touched">

    <div class="field style-4">
      <label for="titleInput">{{bookform.title.label}}</label>
      <input type="text" id="titleInput" placeholder="{{bookform.title.placeholder}}" [formControl]="ficheForm.controls['title']">
      <div *ngIf="ficheForm.controls['title'].hasError('required')" class="minialert-box error">{{bookform.title.required}}</div>
    </div>

    <div class="field style-4">
      <label for="subTitleInput">{{bookform.subtitle.label}}</label>
      <input type="text" id="subTitleInput" placeholder="{{bookform.subtitle.placeholder}}" [formControl]="ficheForm.controls['subTitle']">
    </div>

    <div class="field style-4">
      <label for="authorInput">{{bookform.author.label}}</label>
      <input type="text" id="authorInput" placeholder="{{bookform.author.placeholder}}" [formControl]="ficheForm.controls['author']">
      <div *ngIf="ficheForm.controls['author'].hasError('required')" class="minialert-box error">{{bookform.author.required}}</div>
    </div>

    <div class="field style-4">
      <label for="authorNationality">{{bookform.nationality.label}}</label>
      <input type="text" id="authorNationality" placeholder="{{bookform.nationality.placeholder}}" [formControl]="ficheForm.controls['author_nationality']">
    </div>

    <div class="field style-4">
      <label for="authorPeriod">{{bookform.period.label}}</label>
      <input type="text" id="authorPeriod" placeholder="{{bookform.period.placeholder}}" [formControl]="ficheForm.controls['author_period']">
    </div>

    <div class="field style-4">
      <label for="yearPubInput">{{bookform.year.label}}</label>
      <input type="number" class="no-spin" id="yearPubInput" placeholder="{{bookform.year.placeholder}}" [formControl]="ficheForm.controls['yearPub']">
    </div>

    <div class="field style-4">
      <label for="editorInput">{{bookform.editor.label}}</label>
      <input type="text" id="editorInput" placeholder="{{bookform.editor.placeholder}}" [formControl]="ficheForm.controls['editor']">
    </div>

    <div class="field style-4">
      <label for="collectionInput">{{bookform.collection.label}}</label>
      <input type="text" id="collectionInput" placeholder="{{bookform.collection.placeholder}}" [formControl]="ficheForm.controls['collection']">
    </div>

    <div class="field style-4">
      <label for="pagesInput">{{bookform.pages.label}}</label>
      <input type="number" class="no-spin" id="pagesInput" placeholder="{{bookform.pages.placeholder}}" [formControl]="ficheForm.controls['pages']">
    </div>

    <div class="field style-4">
      <label for="languageInput">{{bookform.language.label}}</label>
      <input type="text" id="languageInput" placeholder="{{bookform.language.placeholder}}" [formControl]="ficheForm.controls['language']">
    </div>

    <div class="field style-4">
      <label for="translationInput">{{bookform.translation.label}}</label>
      <input type="text" id="translationInput" placeholder="{{bookform.translation.placeholder}}" [formControl]="ficheForm.controls['translation']">
    </div>

    <div class="field style-4">
      <label for="optionalOneInput">{{bookform.optional_one.label}}</label>
      <input type="text" id="optionalOneInput" placeholder="{{bookform.optional_one.placeholder}}" [formControl]="ficheForm.controls['optional_one']">
    </div>

    <!-- Now the form to add a comment-->

    <div formArrayName="comments">

      <div *ngFor="let comment of ficheForm.controls.comments.controls; let i=index">

        <div class="panel-heading">
          <div>
            <h4>{{labels[0].new.comment}} {{i + 1}} {{labels[0].new.author}} {{author}}</h4>
            <button *ngIf="ficheForm.controls.comments.controls.length > 1" (click)="removeComment(i)">{{labels[0].new.remove}}</button>
          </div>
        </div>

        <div class="panel-body" [formGroupName]="i">

          <div>
            <h4 for="aboutAuthor">{{commentform.aboutauthor.label}}</h4>
            <textarea id="aboutAuthor" name="aboutAuthor" placeholder="{{commentform.aboutauthor.placeholder}}" formControlName="aboutAuthor"></textarea>
          </div>

          <div>
            <h4 for="aboutGenre">{{commentform.genre.label}}</h4>
            <textarea id="aboutGenre" placeholder="{{commentform.genre.placeholder}}" formControlName="aboutGenre"></textarea>
          </div>

          <div>
            <h4 for="aboutCadre">{{commentform.context.label}}</h4>
            <textarea id="aboutCadre" placeholder="{{commentform.context.placeholder}}" formControlName="aboutCadre"></textarea>
          </div>

          <div>
            <h4 for="aboutCharacters">{{commentform.characters.label}}</h4>
            <textarea id="aboutCharacters" placeholder="{{commentform.characters.placeholder}}" formControlName="aboutCharacters"></textarea>
          </div>

          <div>
            <h4 for="resume">{{commentform.resume.label}}</h4>
            <textarea id="resume" placeholder="{{commentform.resume.placeholder}}" formControlName="resume"></textarea>
          </div>

          <div>
            <h4 for="extrait">{{commentform.extraits.label}}</h4>
            <textarea id="extrait" placeholder="{{commentform.extraits.placeholder}}" formControlName="extrait"></textarea>
          </div>

          <div>
            <h4 for="appreciation">{{commentform.appreciation.label}}</h4>
            <textarea id="appreciation" placeholder="{{commentform.appreciation.placeholder}}" formControlName="appreciation"></textarea>
          </div>

          <div>
            <h4 for="optional_one">{{commentform.optional_one.label}}</h4>
            <textarea id="optional_one" placeholder="{{commentform.optional_one.placeholder}}" formControlName="optional_one"></textarea>
          </div>

          <div>
            <h4 for="optional_two">{{commentform.optional_two.label}}</h4>
            <textarea id="optional_two" placeholder="{{commentform.optional_two.placeholder}}" formControlName="optional_two"></textarea>
          </div>

          <div>
            <h4 for="comment_text">{{commentform.comment_text.label}}</h4>
            <textarea id="comment_text" placeholder="{{commentform.comment_text.placeholder}}" formControlName="comment_text"></textarea>
          </div>

          <div>
            <h4 for="other_details">{{commentform.other_details.label}}</h4>
            <textarea id="other_details" placeholder="{{commentform.other_details.placeholder}}" formControlName="other_details"></textarea>
          </div>

          <div>
            <h4 for="isCompleted">{{commentform.iscompleted.label}}</h4>
            <md-checkbox class="style-5" id="isCompleted{{i}}" formControlName="isCompleted">
            </md-checkbox>
          </div>

        </div>

      </div>

    </div>

    <!--
    <div class="add-comment" style="margin: 2em">
      <button type="button" (click)="addComment()">{{labels[0].new.addcomment}}</button>
    </div> -->

    <div>

      <div style="margin: 2em">
        <button type="submit" class="positive" [disabled]="!ficheForm.valid">{{labels[0].new.submit}}</button>
        <button type="reset" class="negative" (click)="revert()" [disabled]="ficheForm.pristine">{{labels[0].new.cancel}}</button>
      </div>

    </div>

  </form>

  <div class="message-box center">

    <div *ngIf="message">
      <div class="alert-box {{message.type}}"><span>{{message.text}}</span></div>
    </div>

  </div>

  <!--<p>Form value: {{ ficheForm.value | json }}</p>-->

</div>

<div>

  <h3>{{labels[0].new.upload}}</h3>

  <div class="add-comment" style="margin: 2em">
    <input #fileInput type="file" accept=".csv" id="file" class="inputfile" (change)="fileChanged($event)" />
    <label for="file">{{labels[0].new.choosefile}}</label>
    <button (click)="uploadFile()">{{labels[0].new.send}}</button>
    <div *ngIf="csvFileName">
        <h4>{{csvFileName}}</h4>
    </div>
  </div>



</div>